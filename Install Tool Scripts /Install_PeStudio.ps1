# Step 1: Define the GitHub repository and the target folder
$repoUrl = "https://github.com/jcphillips51/Malware-Analysis-Tools/archive/refs/heads/main.zip"
$downloadPath = "$env:TEMP\Malware-Analysis-Tools.zip"
$extractPath = "$env:TEMP\Malware-Analysis-Tools"

# Step 2: Download the files from the GitHub repository
Write-Host "Downloading the repository..."
Invoke-WebRequest -Uri $repoUrl -OutFile $downloadPath

# Step 3: Navigate to the PeStudio directory
$pestudioPath = "$extractPath\Malware-Analysis-Tools-main\PeStudio"
Set-Location -Path $pestudioPath

# Step 4: Run the pestudio.exe application
Write-Host "Running PeStudio..."
Start-Process "$pestudioPath\pestudio.exe"

# Optional: Clean up downloaded and extracted files
# Write-Host "Cleaning up..."
# Remove-Item -Path $downloadPath -Force
# Remove-Item -Path $extractPath -Recurse -Force

Write-Host "PeStudio has been executed."
