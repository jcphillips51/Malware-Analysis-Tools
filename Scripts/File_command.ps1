function Get-FileType {
    param (
        [Parameter(Mandatory = $true)]
        [string]$FilePath
    )

    if (-not (Test-Path $FilePath)) {
        Write-Error "File not found: $FilePath"
        return
    }

    $signature = Get-Content -Path $FilePath -Raw -Encoding Byte -TotalCount 4
    $hexSignature = ($signature | ForEach-Object { "{0:X2}" -f $_ }) -join ""

    switch ($hexSignature) {
        'FFD8FFE0' { return "JPEG Image" }
        '89504E47' { return "PNG Image" }
        '47494638' { return "GIF Image" }
        '25504446' { return "PDF Document" }
        '504B0304' { return "ZIP Archive" }
        '4D5A9000' { return "Executable File (EXE)" }
        default {
            $file = Get-Item $FilePath
            return $file.PSIsContainer ? "Directory" : "Unknown file type"
        }
    }
}

# Example usage:
# Get-FileType -FilePath "C:\path\to\your\file"
