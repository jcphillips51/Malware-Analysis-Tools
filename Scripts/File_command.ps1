function Get-FileType {
    param (
        [Parameter(Mandatory = $true)]
        [string]$FilePath
    )

    if (-not (Test-Path $FilePath)) {
        Write-Error "File not found: $FilePath"
        return
    }

    $signature = Get-Content -Path $FilePath -Raw -Encoding Byte -TotalCount 4
    $hexSignature = ($signature | ForEach-Object { "{0:X2}" -f $_ }) -join ""

    switch ($hexSignature) {
        'FFD8FFE0' { return "JPEG Image" }
        '89504E47' { return "PNG Image" }
        '47494638' { return "GIF Image" }
        '25504446' { return "PDF Document" }
        '504B0304' { return "ZIP Archive" }
        '4D5A9000' { return "Executable File (EXE)" }
        default {
            # Additional check to see if the file is a text file
            $fileContent = Get-Content -Path $FilePath -Raw -Encoding Byte
            $printableChars = $fileContent | Where-Object { $_ -ge 32 -and $_ -le 126 }
            $printableRatio = ($printableChars.Count / $fileContent.Length) * 100

            if ($printableRatio -gt 90) {
                return "Text File"
            } elseif ($file.PSIsContainer) {
                return "Directory"
            } else {
                return "Unknown file type"
            }
        }
    }
}

# Example usage:
Get-FileType -FilePath "C:\path\to\your\file.txt"
